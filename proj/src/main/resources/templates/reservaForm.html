<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Reservar Casa</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        #detalle-casa img {
            width: 100%;
            max-height: 200px;
            object-fit: cover;
        }
    </style>
</head>
<body class="bg-light">
    <div class="container mt-4">
        <h2>Confirmar Reserva</h2>
        
        <!-- Información de la casa seleccionada -->
        <div class="card mb-4">
            <div class="card-header">
                <h5>Casa Seleccionada</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <img th:src="${casa.imagen}" class="img-fluid rounded" alt="Imagen de la casa" />
                    </div>
                    <div class="col-md-8">
                        <h6 th:text="${casa.nombre}"></h6>
                        <p><strong>Dirección:</strong> <span th:text="${casa.direccion}"></span></p>
                        <p><strong>Habitaciones:</strong> <span th:text="${casa.habitaciones}"></span></p>
                        <p><strong>Precio:</strong> S/. <span th:text="${casa.precio}"></span></p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Formulario de reserva simplificado -->
        <form th:action="@{/casas/reserva/nueva}" th:object="${reserva}" method="post">
            
            <!-- Campo oculto con el ID de la casa -->
            <input type="hidden" name="idCasaCampo" th:value="${casa.id_casa}" />
            
            <div class="card">
                <div class="card-header">
                    <h5>Datos de la Reserva</h5>
                </div>
                <div class="card-body">
                    
                    <!-- Mostrar nombre del usuario (solo lectura) -->
                    <div class="mb-3">
                        <label class="form-label">Cliente</label>
                        <input type="text" class="form-control" th:value="${usuarioLogueado.nombre}" readonly />
                    </div>

                    <!-- Teléfono -->
                    <div class="mb-3">
                        <label for="telefono" class="form-label">Teléfono de contacto</label>
                        <input type="tel" id="telefono" th:field="*{telefono}" class="form-control" 
                            placeholder="Ej: 987654321" required />
                    </div>

                    <!-- Fecha y hora de reserva -->
                    <div class="mb-3">
                        <label for="fechaReserva" class="form-label">Fecha y Hora de la Reserva</label>
                        <input type="datetime-local" id="fechaReserva" th:field="*{fechaReserva}" 
                            class="form-control" required />
                    </div>

                    <!-- Botones -->
                    <div class="d-flex gap-2">
                        <button type="submit" class="btn btn-success">
                            <i class="fas fa-check"></i> Confirmar Reserva
                        </button>
                        <a th:href="@{'/casas/' + ${casa.id_casa}}" class="btn btn-secondary">
                            <i class="fas fa-arrow-left"></i> Volver a Detalles
                        </a>
                    </div>
                    
                </div>
            </div>
        </form>
    </div>
</body>
</html>
